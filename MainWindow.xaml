<Window x:Class="ServerLauncher.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Server Launcher" Height="760" Width="1180"
        Background="{StaticResource PrimaryBrush}"
        Foreground="{StaticResource TextBrush}"
        WindowStartupLocation="CenterScreen">
    
    <Grid>
        <!-- Header -->
        <Grid Height="78" VerticalAlignment="Top" Background="{StaticResource SecondaryBrush}">
            <Border BorderBrush="#1F2937" BorderThickness="0,0,0,2" VerticalAlignment="Center">
                <Grid Margin="28,14">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Orientation="Vertical">
                        <TextBlock Text="SERVER LAUNCHER" FontSize="26" FontWeight="Bold" Foreground="{StaticResource AccentBrush}"/>
                        <TextBlock x:Name="StatusText" Text="Ready" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                    </StackPanel>
                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                        <Button Content="⚙ Settings" Click="OpenSettings_Click" Style="{StaticResource LaunchButton}" Padding="12,6" FontSize="12"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>

        <!-- Main Content -->
        <Grid Margin="0,78,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="360"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Servers Panel with Scroll (Dynamic List) -->
            <Border Grid.Column="0" Background="{StaticResource SecondaryBrush}" Margin="16" BorderBrush="#1F2937" BorderThickness="1" CornerRadius="10">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="18">
                        <TextBlock Text="SERVERS" FontSize="14" FontWeight="Bold" Foreground="{StaticResource AccentBrush}"/>
                        <ItemsControl x:Name="ServersList">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#0B1220" BorderBrush="#1F2937" BorderThickness="1" CornerRadius="8" Padding="14" Margin="0,12,0,0">
                                        <StackPanel>
                                            <TextBlock Text="{Binding Name}" FontSize="13" FontWeight="Bold" Foreground="{StaticResource TextBrush}"/>
                                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                                <Button Content="▶ Start" Style="{StaticResource LaunchButton}" Padding="12,8" Margin="0,0,8,0" Click="StartServer_Click" Tag="{Binding}"/>
                                                <Button Content="⏹ Stop" Style="{StaticResource LaunchButton}" Background="{StaticResource ErrorBrush}" Padding="12,8" Click="StopServer_Click" Tag="{Binding}"/>
                                                <Button Content="✖ Remove" Style="{StaticResource LaunchButton}" Padding="12,8" Margin="8,0,0,0" Click="RemoveServer_Click" Tag="{Binding}"/>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0" VerticalAlignment="Center">
                                                <Ellipse Width="12" Height="12" Fill="{Binding StatusBrush}"/>
                                                <TextBlock Text="{Binding StatusText}" FontSize="11" Foreground="{StaticResource TextSecondaryBrush}" Margin="8,0,0,0"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </ScrollViewer>
            </Border>

            <!-- Right Side: Output + Toggleable Settings -->
            <Grid Grid.Column="1" Margin="0,16,16,16" x:Name="RightPane">
                <!-- Output Panel -->
                <Border x:Name="OutputPanel" Background="{StaticResource SecondaryBrush}" BorderBrush="#1F2937" BorderThickness="1" CornerRadius="10">
                    <Grid Margin="18">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBlock Text="Output" FontSize="15" FontWeight="SemiBold" Foreground="{StaticResource AccentBrush}"/>

                        <Border Grid.Row="1" Background="#0B1220" BorderBrush="#1F2937" BorderThickness="1" CornerRadius="8">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <TextBlock x:Name="OutputText" 
                                           Text="[Ready]\n" 
                                               Foreground="{StaticResource AccentBrush}" 
                                               FontFamily="Consolas" 
                                               FontSize="12" 
                                               Margin="14"
                                           TextWrapping="Wrap"/>
                            </ScrollViewer>
                        </Border>
                    </Grid>
                </Border>

                <!-- Backdrop dim behind Settings -->
                <Rectangle x:Name="Backdrop" Fill="#000000" Opacity="0.35" Visibility="Collapsed" RadiusX="8" RadiusY="8"/>

                <!-- Settings Overlay Panel -->
                <Border x:Name="SettingsPanel" Visibility="Collapsed" Background="{StaticResource SecondaryBrush}" BorderBrush="#1F2937" BorderThickness="1" CornerRadius="10" Margin="0" Padding="0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Settings Header with Close -->
                        <Grid Background="#0B1220" Height="50" VerticalAlignment="Top">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Settings" FontSize="16" FontWeight="Bold" Foreground="{StaticResource AccentBrush}" VerticalAlignment="Center" Margin="16,0"/>
                            <Button Grid.Column="1" Content="✖ Close" Click="CloseSettings_Click" Style="{StaticResource LaunchButton}" Padding="12,8" Margin="0,0,16,0"/>
                        </Grid>

                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                            <StackPanel Margin="18">
                                <TextBlock Text="Server Settings" FontSize="15" FontWeight="SemiBold" Foreground="{StaticResource AccentBrush}"/>

                                <!-- API Settings -->
                                <Border Background="#0B1220" BorderBrush="#1F2937" BorderThickness="1" CornerRadius="8" Padding="14" Margin="0,14,0,0">
                                    <StackPanel>
                                        <TextBlock Text="API Server" FontSize="13" FontWeight="SemiBold" Foreground="{StaticResource TextBrush}"/>
                                        <TextBlock Text="Display Name" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,8,0,0"/>
                                        <TextBox x:Name="ApiNameInput" Text="API Server" Background="#0F172A" Foreground="{StaticResource TextBrush}" BorderBrush="#1F2937" Margin="0,4,0,0"/>
                                        <TextBlock Text="Executable / Script" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,8,0,0"/>
                                        <DockPanel Margin="0,2,0,0">
                                            <TextBox x:Name="ApiPathInput" Background="#0F172A" Foreground="{StaticResource TextBrush}" BorderBrush="#1F2937" MinWidth="200"/>
                                            <Button Content="Browse" Click="BrowseApi_Click" Style="{StaticResource LaunchButton}" Padding="10,6" Margin="8,0,0,0"/>
                                        </DockPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Web Settings -->
                                <Border Background="#0B1220" BorderBrush="#1F2937" BorderThickness="1" CornerRadius="8" Padding="14" Margin="0,14,0,0">
                                    <StackPanel>
                                        <TextBlock Text="Web Server" FontSize="13" FontWeight="SemiBold" Foreground="{StaticResource TextBrush}"/>
                                        <TextBlock Text="Display Name" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,8,0,0"/>
                                        <TextBox x:Name="WebNameInput" Text="Web Server" Background="#0F172A" Foreground="{StaticResource TextBrush}" BorderBrush="#1F2937" Margin="0,4,0,0"/>
                                        <TextBlock Text="Executable / Script" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,8,0,0"/>
                                        <DockPanel Margin="0,2,0,0">
                                            <TextBox x:Name="WebPathInput" Background="#0F172A" Foreground="{StaticResource TextBrush}" BorderBrush="#1F2937" MinWidth="200"/>
                                            <Button Content="Browse" Click="BrowseWeb_Click" Style="{StaticResource LaunchButton}" Padding="10,6" Margin="8,0,0,0"/>
                                        </DockPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Database Settings -->
                                <Border Background="#0B1220" BorderBrush="#1F2937" BorderThickness="1" CornerRadius="8" Padding="14" Margin="0,14,0,0">
                                    <StackPanel>
                                        <TextBlock Text="Database" FontSize="13" FontWeight="SemiBold" Foreground="{StaticResource TextBrush}"/>
                                        <TextBlock Text="Display Name" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,8,0,0"/>
                                        <TextBox x:Name="DbNameInput" Text="Database" Background="#0F172A" Foreground="{StaticResource TextBrush}" BorderBrush="#1F2937" Margin="0,4,0,0"/>
                                        <TextBlock Text="Executable / Script" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,8,0,0"/>
                                        <DockPanel Margin="0,2,0,0">
                                            <TextBox x:Name="DbPathInput" Background="#0F172A" Foreground="{StaticResource TextBrush}" BorderBrush="#1F2937" MinWidth="200"/>
                                            <Button Content="Browse" Click="BrowseDb_Click" Style="{StaticResource LaunchButton}" Padding="10,6" Margin="8,0,0,0"/>
                                        </DockPanel>
                                    </StackPanel>
                                </Border>

                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,10,0,0">
                                    <Button Content="Add Server" Click="AddServer_Click" Style="{StaticResource LaunchButton}" Padding="14,8" Margin="0,0,10,0"/>
                                    <Button Content="Save Settings" Click="SaveSettings_Click" Style="{StaticResource LaunchButton}" Padding="16,10" Margin="0,0,10,0"/>
                                    <TextBlock x:Name="SettingsInfo" Text="" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Grid>
</Window>
